<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Chat Verde ‚Äî Demo Directa a OpenAI</title>
  <style>
    /* ======= Tema base verdoso (teal/emerald) ======= */
:root{
  --bg-0: #0b1a16;            /* base oscura */
  --bg-1: #0f2a24;            /* capa 1 */
  --glass: hsla(165, 25%, 90%, 0.06);
  --border: hsla(165, 40%, 80%, 0.18);
  --text: #e8f6f1;
  --muted: #a8c8bd;
  --brand: #1dd1a1;           /* verde menta */
  --brand-2: #10b981;         /* emerald */
  --brand-3: #2dd4bf;         /* teal aqua */
  --shadow: 0 8px 30px rgba(0,0,0,.35);
  --radius-xl: 22px;
  --radius-lg: 16px;
  --radius-md: 12px;
}

/* Reset m√≠nimo */
*{ box-sizing: border-box; }
html, body{
  height: 100%;
  background: var(--bg-0);
  color: var(--text);
  font: 500 16px/1.5 ui-sans-serif, system-ui, -apple-system, "Segoe UI",
        Roboto, "Helvetica Neue", Arial, "Noto Sans", "Apple Color Emoji", "Segoe UI Emoji";
  margin: 0;
}

/* Fondos decorativos */
.bg-grid{
  position: fixed; inset: 0; pointer-events: none; z-index: 0;
  background-image:
    radial-gradient(transparent 1px, rgba(255,255,255,.02) 1px);
  background-size: 22px 22px;
}
.bg-gradient{
  position: fixed; inset: -20% -10% auto -10%; height: 60vh; z-index: 0;
  background:
    radial-gradient(60% 60% at 20% 20%, rgba(45,212,191,.18), transparent 60%),
    radial-gradient(50% 50% at 80% 0%, rgba(16,185,129,.18), transparent 60%),
    radial-gradient(30% 30% at 50% 100%, rgba(29,209,161,.15), transparent 60%);
  filter: blur(30px) saturate(120%);
}

/* App container */
.chat-app{
  position: relative;
  z-index: 1;
  width: min(920px, 100%);
  margin: min(6vh, 64px) auto;
  display: grid;
  grid-template-rows: auto 1fr auto;
  gap: 14px;
  padding: 14px;
}

/* Topbar */
.topbar{
  display: flex; align-items: center; justify-content: space-between;
  background: linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.03));
  border: 1px solid var(--border);
  backdrop-filter: blur(14px) saturate(120%);
  border-radius: var(--radius-xl);
  padding: 12px 14px 12px 12px;
  box-shadow: var(--shadow);
}
.brand{ display: inline-flex; align-items: center; gap: 10px; }
.brand h1{
  font-size: 16px; letter-spacing: .4px; margin: 0;
}
.brand-dot{
  width: 22px; height: 22px; border-radius: 999px;
  background: conic-gradient(from 0deg,
    var(--brand), var(--brand-2), var(--brand-3), var(--brand));
  box-shadow: 0 0 18px rgba(45,212,191,.55), inset 0 0 12px rgba(255,255,255,.25);
}
.icon-btn{
  appearance: none; border: none; cursor: pointer;
  background: transparent; color: var(--muted);
  padding: 8px; border-radius: 10px;
  transition: transform .12s ease, background .2s ease, color .2s ease;
}
.icon-btn:hover{ background: var(--glass); color: var(--text); transform: translateY(-1px); }
.topbar-actions{ display: inline-flex; gap: 6px; }

/* Chat window */
.chat-window{
  background: linear-gradient(180deg, rgba(255,255,255,.05), rgba(255,255,255,.02));
  border: 1px solid var(--border);
  border-radius: var(--radius-xl);
  box-shadow: var(--shadow);
  min-height: 60vh; max-height: 70vh;
  padding: 14px;
  display: grid; grid-template-rows: 1fr;
  overflow: hidden;
}

.messages{
  list-style: none; margin: 0; padding: 0 6px;
  overflow-y: auto; scroll-behavior: smooth;
  display: flex; flex-direction: column; gap: 12px;
}
.messages::-webkit-scrollbar{ width: 10px; }
.messages::-webkit-scrollbar-thumb{
  background: rgba(45,212,191,.25); border-radius: 999px;
  border: 2px solid transparent; background-clip: padding-box;
}

/* Mensajes */
.msg{
  display: grid; grid-template-columns: 32px 1fr; gap: 10px; align-items: end;
  animation: pop .18s ease;
}
@keyframes pop{ from{ transform: translateY(4px); opacity: .0; } to{ transform: none; opacity: 1; } }

.msg.user{ grid-template-columns: 1fr 32px; }
.msg .avatar{
  width: 32px; height: 32px; display: grid; place-items: center; border-radius: 999px;
  background: rgba(255,255,255,.06); border: 1px solid var(--border);
  font-size: 16px;
}
.msg .bubble{
  position: relative;
  background: rgba(255,255,255,.06);
  border: 1px solid var(--border);
  backdrop-filter: blur(10px) saturate(120%);
  border-radius: 18px;
  padding: 10px 12px;
  color: var(--text);
  max-width: min(72ch, 92%);
}

/* Bot bubble */
.msg.bot .bubble{
  border-top-left-radius: 8px;
}

/* User bubble (gradiente verde) */
.msg.user .bubble{
  margin-left: auto;
  background: linear-gradient(135deg, rgba(16,185,129,.25), rgba(45,212,191,.18));
  border: 1px solid rgba(45,212,191,.35);
  border-top-right-radius: 8px;
}

/* Timestamps */
.bubble time{
  display: inline-block; margin-top: 6px;
  font-size: 12px; color: var(--muted);
}

/* Typing dots */
.msg.typing .bubble{ width: 64px; }
.dots{
  display: inline-flex; gap: 6px; align-items: center; height: 18px;
}
.dots i{
  width: 6px; height: 6px; border-radius: 999px; background: var(--muted);
  animation: blink 1s infinite ease-in-out;
}
.dots i:nth-child(2){ animation-delay: .15s; }
.dots i:nth-child(3){ animation-delay: .3s; }
@keyframes blink{ 0%, 80%, 100%{ opacity: .2; transform: translateY(0); } 40%{ opacity: 1; transform: translateY(-3px);} }

/* Composer */
.composer{
  display: grid; grid-template-columns: 1fr auto; gap: 10px;
  background: linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.03));
  border: 1px solid var(--border);
  border-radius: var(--radius-xl);
  box-shadow: var(--shadow);
  padding: 10px;
}
.input{
  width: 100%; border: 1px solid transparent; outline: none;
  border-radius: var(--radius-lg);
  padding: 12px 14px;
  color: var(--text); background: rgba(255,255,255,.04);
  transition: border .2s ease, box-shadow .2s ease, background .2s ease;
}
.input::placeholder{ color: #9bb8b0; }
.input:focus{
  border-color: rgba(45,212,191,.45);
  box-shadow: 0 0 0 6px rgba(45,212,191,.12);
  background: rgba(255,255,255,.06);
}
.send{
  display: inline-flex; align-items: center; gap: 8px;
  border: 0; cursor: pointer; padding: 0 14px;
  border-radius: var(--radius-lg);
  background: linear-gradient(135deg, var(--brand-2), var(--brand-3));
  color: #04221b; font-weight: 700; letter-spacing: .2px;
  box-shadow: 0 6px 18px rgba(45,212,191,.35), inset 0 0 0 1px rgba(255,255,255,.3);
  transition: transform .12s ease, filter .2s ease, box-shadow .2s ease;
}
.send:hover{ transform: translateY(-1px); filter: saturate(1.1); }
.send:active{ transform: translateY(0); box-shadow: 0 4px 12px rgba(45,212,191,.28); }
.send span{ display: none; }           /* solo √≠cono en mobile */
@media (min-width: 520px){ .send span{ display: inline; } }

/* Responsive tweaks */
@media (max-width: 640px){
  .chat-app{ margin: 20px auto; padding: 10px; }
  .chat-window{ min-height: 56vh; max-height: 62vh; }
}
  </style>
</head>
<body>
  <!-- Fondo -->
  <div class="bg-grid"></div>
  <div class="bg-gradient"></div>

  <main class="chat-app" role="main" aria-label="Chatbot verde">
    <!-- Topbar -->
    <header class="topbar">
      <div class="brand">
        <span class="brand-dot" aria-hidden="true"></span>
        <h1>Chat Verde</h1>
      </div>
      <div class="topbar-actions">
        <button class="icon-btn" aria-label="Nuevo chat" title="Nuevo chat">
          <svg viewBox="0 0 24 24" width="20" height="20" aria-hidden="true">
            <path d="M12 5v14M5 12h14" stroke="currentColor" stroke-width="1.7" stroke-linecap="round"/>
          </svg>
        </button>
        <button class="icon-btn" aria-label="Ajustes" title="Ajustes">
          <svg viewBox="0 0 24 24" width="20" height="20" aria-hidden="true">
            <path d="M12 15.5a3.5 3.5 0 1 0 0-7 3.5 3.5 0 0 0 0 7Z" stroke="currentColor" stroke-width="1.6"/>
            <path d="M19.4 15a1.7 1.7 0 0 0 .34 1.86l.06.06a2 2 0 1 1-2.83 2.83l-.06-.06a1.7 1.7 0 0 0-1.86-.34 1.7 1.7 0 0 0-1 1.55V21a2 2 0 1 1-4 0v-.1a1.7 1.7 0 0 0-1-1.55 1.7 1.7 0 0 0-1.86.34l-.06.06a2 2 0 1 1-2.83-2.83l.06-.06a1.7 1.7 0 0 0 .34-1.86 1.7 1.7 0 0 0-1.55-1H3a2 2 0 1 1 0-4h.1a1.7 1.7 0 0 0 1.55-1 1.7 1.7 0 0 0-.34-1.86l-.06-.06A2 2 0 1 1 6.08 4.4l.06.06a1.7 1.7 0 0 0 1.86.34 1.7 1.7 0 0 0 1-1.55V3a2 2 0 1 1 4 0v.1a1.7 1.7 0 0 0 1 1.55 1.7 1.7 0 0 0 1.86-.34l.06-.06a2 2 0 1 1 2.83 2.83l-.06.06a1.7 1.7 0 0 0-.34 1.86 1.7 1.7 0 0 0 1.55 1H21a2 2 0 1 1 0 4h-.1a1.7 1.7 0 0 0-1.55 1Z" stroke="currentColor" stroke-width="1" fill="none"/>
          </svg>
        </button>
      </div>
    </header>

    <!-- Area de mensajes -->
    <section class="chat-window" aria-live="polite">
      <ul class="messages">
        <li class="msg bot">
          <div class="avatar" aria-hidden="true">ü§ñ</div>
          <div class="bubble">
            <p>¬°Hey! Soy tu bot verdoso. ¬øQu√© construimos hoy? üå±</p>
            <time datetime="2025-10-04T18:00">18:00</time>
          </div>
        </li>

        <li class="msg user">
          <div class="bubble">
            <p>Quiero probar el layout y ver estilos.</p>
            <time datetime="2025-10-04T18:01">18:01</time>
          </div>
          <div class="avatar" aria-hidden="true">üßëüèª‚Äçüíª</div>
        </li>

        <li class="msg bot typing">
          <div class="avatar" aria-hidden="true">ü§ñ</div>
          <div class="bubble">
            <span class="dots" aria-label="el bot est√° escribiendo" title="escribiendo">
              <i></i><i></i><i></i>
            </span>
          </div>
        </li>
      </ul>
    </section>

    <!-- Composer -->
    <form class="composer" aria-label="Enviar mensaje (demo)" onsubmit="return false;">
      <input type="text" class="input" placeholder="Escribe un mensaje..." aria-label="Mensaje"/>
      <button class="send" type="button" aria-label="Enviar">
        <svg viewBox="0 0 24 24" width="20" height="20" aria-hidden="true">
          <path d="M3 12l17-7-5 7 5 7-17-7z" fill="currentColor"/>
        </svg>
        <span>Enviar</span>
      </button>
    </form>
  </main>

  <!-- === L√≥gica de API OpenAI (directo desde el navegador) === -->
  <script>
    // ‚ö† Para DEMO: clave incrustada (rotar despu√©s s√≠ o s√≠)
    const OPENAI_API_KEY = "NUH-UH";

    // Endpoint cl√°sico de Chat Completions (funciona para gpt-4o-mini)
    const OPENAI_URL = "https://api.openai.com/v1/chat/completions";

    async function askLLM(userText){
      // Nota: si el navegador bloquea por CORS,
      // graba la demo con un navegador lanzado con web security desactivado
      // o sirve este archivo con un proxy local.
      const r = await fetch(OPENAI_URL, {
        method: "POST",
        headers: {
          "Authorization": Bearer ${OPENAI_API_KEY},
          "Content-Type": "application/json"
        },
        body: JSON.stringify({
          model: "gpt-4o-mini",
          temperature: 0.2,
          messages: [
            { role: "system", content: "Eres un asistente t√©cnico, claro y conciso." },
            { role: "user", content: userText }
          ]
        })
      });

      if(!r.ok){
        const txt = await r.text().catch(()=> "");
        throw new Error(HTTP ${r.status} ‚Äî ${txt});
      }
      const data = await r.json();
      const content = data?.choices?.[0]?.message?.content ?? "";
      return String(content).trim() || "(sin respuesta)";
    }
  </script>

  <!-- === L√≥gica de UI y pegado con askLLM() === -->
  <script>
    (function(){
      const qs = (s, el=document) => el.querySelector(s);
      const messages = qs('.messages');
      const input = qs('.composer .input');
      const sendBtn = qs('.composer .send');

      const esc = (s) => (s||'').replace(/[&<>"']/g, c => ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;','\'':'&#39;'}[c]));
      const now = () => new Date().toLocaleTimeString('es-ES',{hour:'2-digit',minute:'2-digit'});

      function appendUser(text){
        const li = document.createElement('li');
        li.className = 'msg user';
        li.innerHTML = `
          <div class="bubble">
            <p>${esc(text)}</p>
            <time>${now()}</time>
          </div>
          <div class="avatar" aria-hidden="true">üßëüèª‚Äçüíª</div>
        `;
        messages.appendChild(li);
        messages.scrollTop = messages.scrollHeight;
      }

      function appendTyping(){
        const li = document.createElement('li');
        li.className = 'msg bot typing';
        li.innerHTML = `
          <div class="avatar" aria-hidden="true">ü§ñ</div>
          <div class="bubble"><span class="dots" aria-label="el bot est√° escribiendo" title="escribiendo"><i></i><i></i><i></i></span></div>
        `;
        messages.appendChild(li);
        messages.scrollTop = messages.scrollHeight;
        return li;
      }

      function appendBot(text){
        const li = document.createElement('li');
        li.className = 'msg bot';
        li.innerHTML = `
          <div class="avatar" aria-hidden="true">ü§ñ</div>
          <div class="bubble">
            <p>${esc(text)}</p>
            <time>${now()}</time>
          </div>
        `;
        messages.appendChild(li);
        messages.scrollTop = messages.scrollHeight;
      }

      async function send(){
        const text = (input.value || '').trim();
        if(!text) return;
        appendUser(text);
        input.value = '';
        const typing = appendTyping();
        try{
          const reply = await askLLM(text);
          typing.remove();
          appendBot(reply);
        }catch(err){
          typing.remove();
          appendBot('Error: ' + (err?.message || 'desconocido'));
        }
      }

      sendBtn.addEventListener('click', send);
      input.addEventListener('keydown', (e)=>{
        if(e.key === 'Enter' && !e.shiftKey){ e.preventDefault(); send(); }
      });
    })();
  </script>
</body>
</html>